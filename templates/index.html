<!DOCTYPE html>
<html lang="pt-BR">
<head>
<title>Papo Reto</title>
<script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.js" integrity="sha256-yr4fRk/GU1ehYJPAs8P4JlTgu0Hdsp4ZKrx8bDEDC3I=" crossorigin="anonymous"></script>
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='./css/style.css') }}">
<link rel="icon" type="image/png" href="{{ url_for('static', filename='./images/icon.png') }}">
</head>
<body>
<script type="text/javascript" charset="utf-8">
const socket = io();

socket.on('connect', () => {
	socket.emit('connected', {'nickname':document.getElementById('nickname-input').value}, (data) => {
	});
});

socket.on('server_message', (data) => {
	let e = document.createElement('p')
	e.innerHTML = data.nickname+'>> '+data.message;
	document.getElementById('message-box').appendChild(e);
});

function sendMessage(){
	socket.emit('client_message', {'nickname':document.getElementById('nickname-input').value, 'message': document.getElementById('message-input').value});
	document.getElementById('message-input').value = '';
}

function isPressingEnter(e){
	let k;
	if(window.event){
		k = e.keyCode;
		if(k===13){
			sendMessage();
		}
	}else if(e.which){
		k = e.which;
		if(k===13){
			sendMessage();
		}
	}
}

</script>
<h1 id="title">Papo Reto</h1>

<section id="chat-box">
	<section id="message-box">
	</section>
	
	<section id="input-box">
		<input type="text" onkeypress="return isPressingEnter(event)" required placeholder="Digite sua mensagem aqui" id="message-input">
		<button type="button" id="send-button" onclick="sendMessage()" >>></button> 
	</section>
</section>

<section id="nickname-box">
	<label for="nickname-input">Nickname: </label>
	<input type="text" id="nickname-input" autocomplete="off" value="Guest">
</section>

</body>
</html>
